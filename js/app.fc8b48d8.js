(function(e){function t(t){for(var n,o,c=t[0],u=t[1],i=t[2],d=0,l=[];d<c.length;d++)o=c[d],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&l.push(a[o][0]),a[o]=0;for(n in u)Object.prototype.hasOwnProperty.call(u,n)&&(e[n]=u[n]);f&&f(t);while(l.length)l.shift()();return s.push.apply(s,i||[]),r()}function r(){for(var e,t=0;t<s.length;t++){for(var r=s[t],n=!0,o=1;o<r.length;o++){var c=r[o];0!==a[c]&&(n=!1)}n&&(s.splice(t--,1),e=u(u.s=r[0]))}return e}var n={},o={app:0},a={app:0},s=[];function c(e){return u.p+"js/"+({}[e]||e)+"."+{"chunk-7da0364a":"3659c4da"}[e]+".js"}function u(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,u),r.l=!0,r.exports}u.e=function(e){var t=[],r={"chunk-7da0364a":1};o[e]?t.push(o[e]):0!==o[e]&&r[e]&&t.push(o[e]=new Promise((function(t,r){for(var n="css/"+({}[e]||e)+"."+{"chunk-7da0364a":"c3e60325"}[e]+".css",a=u.p+n,s=document.getElementsByTagName("link"),c=0;c<s.length;c++){var i=s[c],d=i.getAttribute("data-href")||i.getAttribute("href");if("stylesheet"===i.rel&&(d===n||d===a))return t()}var l=document.getElementsByTagName("style");for(c=0;c<l.length;c++){i=l[c],d=i.getAttribute("data-href");if(d===n||d===a)return t()}var f=document.createElement("link");f.rel="stylesheet",f.type="text/css",f.onload=t,f.onerror=function(t){var n=t&&t.target&&t.target.src||a,s=new Error("Loading CSS chunk "+e+" failed.\n("+n+")");s.code="CSS_CHUNK_LOAD_FAILED",s.request=n,delete o[e],f.parentNode.removeChild(f),r(s)},f.href=a;var g=document.getElementsByTagName("head")[0];g.appendChild(f)})).then((function(){o[e]=0})));var n=a[e];if(0!==n)if(n)t.push(n[2]);else{var s=new Promise((function(t,r){n=a[e]=[t,r]}));t.push(n[2]=s);var i,d=document.createElement("script");d.charset="utf-8",d.timeout=120,u.nc&&d.setAttribute("nonce",u.nc),d.src=c(e);var l=new Error;i=function(t){d.onerror=d.onload=null,clearTimeout(f);var r=a[e];if(0!==r){if(r){var n=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+n+": "+o+")",l.name="ChunkLoadError",l.type=n,l.request=o,r[1](l)}a[e]=void 0}};var f=setTimeout((function(){i({type:"timeout",target:d})}),12e4);d.onerror=d.onload=i,document.head.appendChild(d)}return Promise.all(t)},u.m=e,u.c=n,u.d=function(e,t,r){u.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},u.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(e,t){if(1&t&&(e=u(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(u.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)u.d(r,n,function(t){return e[t]}.bind(null,n));return r},u.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return u.d(t,"a",t),t},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.p="/Simple-Note/",u.oe=function(e){throw console.error(e),e};var i=window["webpackJsonp"]=window["webpackJsonp"]||[],d=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var f=d;s.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},2395:function(e,t,r){},"2b92":function(e,t,r){"use strict";var n=r("4ba7"),o=r.n(n);o.a},"4ba7":function(e,t,r){},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("2b0e"),o=r("5c96"),a=r.n(o),s=(r("0fae"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("Header"),r("router-view",{staticClass:"rv"})],1)}),c=[],u=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},i=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"header"},[r("div",{staticClass:"main"},[r("div",{staticClass:"title"},[e._v("Simple Notee")])])])}],d={name:"Header",data:function(){return{showMenu:!1}},computed:{user:function(){return this.$store.state.user}}},l=d,f=(r("2b92"),r("2877")),g=Object(f["a"])(l,u,i,!1,null,"a6e92a98",null),p=g.exports,w={name:"learn",components:{Header:p}},v=w,b=(r("7c55"),Object(f["a"])(v,s,c,!1,null,null,null)),m=b.exports,h=(r("d3b7"),r("8c4f")),j=function(){return r.e("chunk-7da0364a").then(r.bind(null,"0558"))};n["default"].use(h["a"]),console.log("/Simple-Note/");var y=[{path:"/",name:"index",redirect:"/note"},{path:"*",name:"404",redirect:"/note"},{path:"/note",name:"note",component:j}],O=new h["a"]({base:"/Simple-Note/",routes:y}),S=O,E=r("5530"),x=r("2f62");n["default"].use(x["a"]);var A=new x["a"].Store({state:{user:JSON.parse(localStorage.getItem("user")||"{}")},mutations:{setUser:function(e,t){e.user=t,localStorage.setItem("user",JSON.stringify(t))},logout:function(e){e.user={},localStorage.removeItem("user")}},actions:{updateUser:function(e,t){var r=e.commit,n=e.state;r("setUser",Object(E["a"])(Object(E["a"])({},n.user),t))}},modules:{},getters:{user:function(e){return e.user}}}),P=(r("4de4"),r("d81d"),{}),_={on:function(e,t,r){var n=[t,r],o=P[e];Array.isArray(o)?o.push(n):P[e]=[n]},remove:function(e,t){var r=P[e];Array.isArray(r)&&(P[e]=r.filter((function(e){return e[0]!==t})))},emit:function(e,t){var r=P[e];Array.isArray(r)&&r.map((function(e){var r=e[0],n=e[1];n.call(r,t)}))},has:function(e){return!!P[e]},off:function(e){P[e]=[]}},D=_,C=r("6a90");n["default"].prototype.$event=D,n["default"].prototype.$cache=C["a"],n["default"].use(a.a),n["default"].config.productionTip=!1,new n["default"]({router:S,store:A,render:function(e){return e(m)}}).$mount("#app")},"6a90":function(e,t,r){"use strict";r("d3b7"),r("ac1f"),r("1276");var n,o=r("ade3"),a=r("5530"),s={database:"simple-note",version:3},c=function(){if(n)return console.log("db already connected");var e=window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.msIndexedDB;if(!e)return alert("你的浏览器版本太旧，将导致本站无法正常使用");var t=e.open(s.database,s.version);t.onsuccess=function(e){n=e.target.result,console.log("***** indexDB connected ******")},t.onerror=function(e){console.log(e.currentTarget.error.message),alert("缓存加载失败，请刷新页面")},t.onupgradeneeded=function(e){if(console.log("db initialization"),n=e.target.result,!n.objectStoreNames.contains("note")){var t=n.createObjectStore("note",{keyPath:"_id",autoIncrement:!0});t.createIndex("tags","tags",{unique:!1}),t.createIndex("content","content",{unique:!1}),t.createIndex("state","state",{unique:!1}),t.createIndex("createdAt","createdAt",{unique:!1}),console.log("tags table created")}}},u=function(){return new Promise((function(e,t){if(!n)return t(new Error("db not connected"));var r=n.transaction("note"),o=r.objectStore("note"),a=[];o.openCursor().onsuccess=function(t){var r=t.target.result;r?(r.value.state&&(r.value.tags=r.value.tags.split(" "),a.push(r.value)),r.continue()):e(a)}}))},i=function(e,t){return new Promise((function(r,o){if(!n)return o(new Error("db not connected"));var a=n.transaction("note","readwrite"),s=a.objectStore("note"),c=s.add({tags:e,content:t,state:1,createdAt:(new Date).toLocaleString()});c.onsuccess=function(e){var t=e.target.result;r(t)},c.onerror=function(e){o(e.target.error)}}))},d=function(e){return new Promise((function(t,r){if(!n)return r(new Error("db not connected"));var o=n.transaction("note","readwrite"),a=o.objectStore("note"),s=a.delete(e);s.onsuccess=function(e){var r=e.target.result;t(r)},s.onerror=function(e){r(e.target.error)}}))},l=function(e){return new Promise((function(t,r){if(!n)return r(new Error("db not connected"));var o=n.transaction("user","readwrite"),a=o.objectStore("user"),s=a.add(e);s.onsuccess=function(e){console.log("new user created"),t(e.target.result)},s.onerror=function(e){r(e.target.error)}}))},f=function(e){return new Promise((function(t,r){if(!n)return r(new Error("db not connected"));var o=n.transaction("user","readwrite"),a=o.objectStore("user"),s=a.get(e);s.onsuccess=function(e){t(e.target.result)},s.onerror=function(e){r(e.target.error)}}))},g=function(e){return new Promise((function(t,r){if(!n)return r(new Error("db not connected"));var o=n.transaction("user","readwrite"),a=o.objectStore("user"),s=a.index("username").get(e.toLowerCase());s.onsuccess=function(e){t(e.target.result)},s.onerror=function(e){r(e.target.error)}}))},p=function(e,t){return new Promise((function(r,o){if(!n)return o(new Error("db not connected"));var s=n.transaction("user","readwrite"),c=s.objectStore("user"),u=c.index("username").get(e.toLowerCase());u.onsuccess=function(n){var s=n.target.result;if(s){if(t!==s.password)return o(new Error("password"));r(n.target.result)}else{s={username:e,password:t,createdAt:Date.now()};var u=c.add(s);u.onsuccess=function(e){console.log("new user created"),r(Object(a["a"])({_id:e.target.result},s))},u.onerror=function(e){o(e.target.error)}}},u.onerror=function(e){o(e.target.error)}}))},w=function(e){return new Promise((function(t,r){if(!n)return r(new Error("db not connected"));var o=n.transaction("learned","readwrite"),a=o.objectStore("learned"),s=a.index("user").get(e);s.onsuccess=function(e){var r=e.target.result||{},n=r.words;t(n||{})},s.onerror=function(e){r(e.target.error)}}))},v=function(e){return new Promise((function(t,r){if(!n)return r(new Error("db not connected"));var o=n.transaction("progress","readwrite"),a=o.objectStore("progress"),s=a.index("user").get(e);s.onsuccess=function(e){var r=e.target.result||{},n=r.lists;t(n||{})},s.onerror=function(e){r(e.target.error)}}))},b=function(e,t){return new Promise((function(r,o){if(!n)return o(new Error("db not connected"));var a=n.transaction("progress","readwrite"),s=a.objectStore("progress"),c=s.index("user").get(e);c.onsuccess=function(e){var n=e.target.result||{},o=n.lists;o&&o[t]?r(o[t]):r({})},c.onerror=function(e){o(e.target.error)}}))},m=function(e,t){return new Promise((function(r,o){if(!n)return o(new Error("db not connected"));var a=n.transaction("learned","readwrite"),s=a.objectStore("learned"),c=s.index("user").get(e);c.onsuccess=function(e){var n=e.target.result||{},o=n.words;o&&o[t]?r(!0):r(!1)},c.onerror=function(e){o(e.target.error)}}))},h=function(e,t,r){var s=r.update,c=void 0===s||s,u=r.period,i=void 0===u?0:u,d=r.stage,l=void 0===d?0:d,f=r.periodChange,g=void 0===f?0:f,p=r.stageChange,w=void 0===p?0:p;return new Promise((function(r,s){if(!n)return s(new Error("db not connected"));var u=t||{},d=u.wordEn,f=u.wordZh;if(!d||!f)return s(new Error("word object incorrect"));var p=n.transaction("learned","readwrite"),v=p.objectStore("learned"),b=v.index("user").get(e);b.onsuccess=function(t){var n=t.target.result,u=!1;if(n){n.words&&n.words[d]?(u=!0,n=Object(a["a"])(Object(a["a"])({},n),{},{words:Object(a["a"])(Object(a["a"])({},n.words),{},Object(o["a"])({},d,{value:f,period:i||n.words[d].period+g,stage:l||n.words[d].stage+w,updatedAt:c?Date.now():n.words[d].updatedAt}))})):n=Object(a["a"])(Object(a["a"])({},n),{},{words:Object(a["a"])(Object(a["a"])({},n.words||{}),{},Object(o["a"])({},d,{value:f,period:i||1,stage:l||7,updatedAt:Date.now()}))});var p=v.put(n);p.onsuccess=function(e){u?(console.log("word status updated"),r("update")):(console.log("new word added to learned"),r("add"))},p.onerror=function(e){s(e.target.error)}}else{n={user:e,words:Object(o["a"])({},d,{value:f,period:i||1,stage:l||7,updatedAt:Date.now()})};var b=v.add(n);b.onsuccess=function(e){console.log("new learned record created"),r("new")},b.onerror=function(e){s(e.target.error)}}},b.onerror=function(e){s(e.target.error)}}))},j=function(e,t,r){var s=r.location,c=void 0===s?0:s,u=r.change,i=void 0===u?0:u;return new Promise((function(r,s){if(!n)return s(new Error("db not connected"));var u=n.transaction("progress","readwrite"),d=u.objectStore("progress"),l=d.index("user").get(e);l.onsuccess=function(n){var u=n.target.result,l=!1;if(u){u.lists&&u.lists[t]?(l=!0,u=Object(a["a"])(Object(a["a"])({},u),{},{lists:Object(a["a"])(Object(a["a"])({},u.lists),{},Object(o["a"])({},t,{startedAt:u.lists[t].startedAt,location:c||u.lists[t].location+i,updatedAt:Date.now()}))})):u=Object(a["a"])(Object(a["a"])({},u),{},{lists:Object(a["a"])(Object(a["a"])({},u.lists||{}),{},Object(o["a"])({},t,{location:c+i,startedAt:Date.now(),updatedAt:Date.now()}))});var f=d.put(u);f.onsuccess=function(e){l?(console.log("list progress edited"),r("update")):(console.log("new list added to progress"),r("add"))},f.onerror=function(e){s(e.target.error)}}else{u={user:e,lists:Object(o["a"])({},t,{location:c+i,startedAt:Date.now(),updatedAt:Date.now()})};var g=d.add(u);g.onsuccess=function(e){console.log("new progress record created"),r("new")},g.onerror=function(e){s(e.target.error)}}},l.onerror=function(e){s(e.target.error)}}))},y={connect:c,newUser:l,getUserById:f,getUserByName:g,userLogin:p,getLearnedByUserId:w,getProgressByUserId:v,getUserListProgress:b,isUserLearnedWord:m,editUserLearned:h,editUserProgress:j,getNotes:u,createNotes:i,deleteNotes:d};c(),t["a"]=y},"7c55":function(e,t,r){"use strict";var n=r("2395"),o=r.n(n);o.a}});
//# sourceMappingURL=app.fc8b48d8.js.map